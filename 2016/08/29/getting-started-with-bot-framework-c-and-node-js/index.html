<!DOCTYPE html><html lang="en-us"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Getting Started with Bot Framework  (Node.js) | teachtyler</title><meta name="description"><meta name="generator" content="teachtyler"><meta name="author" content="Tyler Roberts"><meta name="keywords" content=" front end, design,  developer"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1,user-scalable=0"><link rel="stylesheet" type="text/css" href="/styles/screen.css"><link rel="apple-touch-icon" sizes="57x57" href="/images/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/images/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/images/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/images/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/images/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/images/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/images/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/images/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-180x180.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96x96.png"><link rel="icon" type="image/png" sizes="160x160" href="/images/favicon-160x160.png"><link rel="icon" type="image/png" sizes="192x192" href="/images/favicon-192x192.png"><meta name="msapplication-TileColor" content="#121315"><meta name="msapplication-TileImage" content="/images/mstile-144x144.png"></head><body itemscope itemtype="https://schema.org/WebPage"><header itemscope itemtype="https://schema.org/WPHeader"><h1><a href="/" alt="teachtyler" title="teachtyler" itemprop="headline">teachtyler</a></h1><p itemprop="description">Node.js, Functional Programming, and more.</p><nav itemscope itemtype="https://schema.org/SiteNavigationElement"><ul><li itemprop="name"><a href="/" alt="Home" title="Home" itemprop="url">Home</a></li><li itemprop="name"><a href="/Articles" alt="Articles" title="Articles" itemprop="url">Articles</a></li><li itemprop="name"><a href="/resume" alt="About" title="About" itemprop="url">About</a></li><li itemprop="name"><a href="/portfolio" alt="Portfolio" title="Portfolio" itemprop="url">Portfolio</a></li></ul></nav><div class="space"></div></header><main itemscope itemtype="https://schema.org/Blog"><article class="full"><h1 itemprop="headline">Getting Started with Bot Framework  (Node.js)</h1><span class="post-meta">Published on<time itemprop="datePublished" datetime="2016-08-29T11:10:00.000Z"> Monday, August 29th 2016 at 11:10</time><br>Last updated on<time itemprop="dateModified" datetime="2016-08-29T11:10:00.000Z"> Monday, November 13th 2017 at 16:59</time></span><p>This post will go over how to quickly get a bot up and running, in Node.js (in Azure, other CMS will be another day).</p>
<p>If you don’t already have an Azure account, please go make one. Azure is really cool. These bots can be ran on a free subscription plan. Make sure you select <code>show all</code> when looking at price tiers. Free plan will be at the very bottom, which usually caps out at 1gb of memory per hour. A simple bot won’t reach that cap. I have one that calls API’s of 2 different services while performing multiple responses and making a POST/GET response with every prompt. It genereally hits that limit in about 20 min. Just to give you an idea of the threshhold.</p>
<hr>
<h1 id="Node-js"><a href="#Node-js" class="headerlink" title="Node.js"></a>Node.js</h1><p>For Node we’ll be using the <a href="https://github.com/Microsoft/BotBuilder/blob/master/Node/examples/demo-skype/app.js" target="_blank" rel="external">Skype sample.</a><br>You’ll notice in this folder, there’s no package.json file. For some reason they expected you to download the entire respository and cast <code>npm install</code> on all of their examples. You can do this if you want but you’ll need to register each example seperately and things can get confusing when pushing to Azure. So we’re just going to focus on this one skype sample.</p>
<p>Create a folder. Then <code>&gt; cd</code> into it.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; npm init</div><div class="line">&gt; git init</div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; npm install --save botbuilder</div><div class="line">&gt; npm install --save restify</div></pre></td></tr></table></figure>
<p>package.json file should have updated and look similar to this:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"name"</span>: <span class="string">"nodeskypebot"</span>,</div><div class="line">  <span class="attr">"version"</span>: <span class="string">"0.0.0"</span>,</div><div class="line">  <span class="attr">"description"</span>: <span class="string">""</span>,</div><div class="line">  <span class="attr">"main"</span>: <span class="string">"app.js"</span>,</div><div class="line">  <span class="attr">"scripts"</span>: &#123;</div><div class="line">    <span class="attr">"test"</span>: <span class="string">"test"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"author"</span>: <span class="string">""</span>,</div><div class="line">  <span class="attr">"license"</span>: <span class="string">"ISC"</span>,</div><div class="line">  <span class="attr">"dependencies"</span>: &#123;</div><div class="line">    <span class="attr">"botbuilder"</span>: <span class="string">"^3.2.3"</span>,</div><div class="line">    <span class="attr">"restify"</span>: <span class="string">"^4.1.1"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The package.json file is important to reflect actual packages. When we <code>&gt; git push</code> to Azure, it will run through and install modules on its end. So if you’ve required something in your local node_modules and it’s not a package dependency. Azure will not know to install it, and the app will break.  </p>
<p>Now change app.js to reflect actual location of required paths (diff):<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> restify = <span class="built_in">require</span>(<span class="string">'restify'</span>);</div><div class="line">- <span class="keyword">var</span> builder = <span class="built_in">require</span>(<span class="string">'../../core/'</span>);</div><div class="line">+ <span class="keyword">var</span> builder = <span class="built_in">require</span>(<span class="string">'botbuilder'</span>);</div></pre></td></tr></table></figure></p>
<p>Now you could test locally, with <a href="https://docs.botframework.com/en-us/tools/bot-framework-emulator/" target="_blank" rel="external">Bot framework emulator</a>.<br>We’re going to skip ahead to Azure, where we can test things out in Skype. Because we’re confident! </p>
<hr>
<p>First we need an azure website.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; npm install -g azure-cli</div><div class="line">&gt; azure login</div></pre></td></tr></table></figure></p>
<p>You’ll be asked to enter a code here at <a href="https://aka.ms/devicelogin" target="_blank" rel="external">https://aka.ms/devicelogin</a>. Login with your email that is tied to your azure account.  Command prompt should continue after logging in. </p>
<p><code>&gt; azure site create --git {appname}</code></p>
<p>Follow prompt(s)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; git add .</div><div class="line">&gt; git commit -m &quot;init&quot;</div><div class="line">&gt; git push azure master</div></pre></td></tr></table></figure></p>
<p>You will be presented with Login credentials. ( These are deployment credentials )</p>
<h5 id="If-you-have-never-set-site-credentials-before-on-any-other-web-app"><a href="#If-you-have-never-set-site-credentials-before-on-any-other-web-app" class="headerlink" title="If you have never set site credentials before on any other web app,"></a>If you have never set site credentials before on any other web app,</h5><p>Go to <a href="https://portal.azure.com" target="_blank" rel="external">portal.azure.com</a> and select deployment credentials on the bot sample you just made, these credentials will be the same for every web app on azure. This will be used to login for FTP and pushing to azure.<br><img src="http://i.imgur.com/GxOpC8a.png" alt="alt text"></p>
<hr>
<p>Now that we have a website, with a bot. Let’s <a href="https://dev.botframework.com/bots/new" target="_blank" rel="external">Register the Bot.</a></p>
<p>Messaging endpoint is defined in app.js.<br><a href="https://mydomain.azurewebsites.net/api/messages" target="_blank" rel="external">https://mydomain.azurewebsites.net/api/messages</a><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">server.post(<span class="string">'/api/messages'</span>, connector.listen());</div></pre></td></tr></table></figure></p>
<p><img src="http://i.imgur.com/PusWEcI.png" alt="configuration"></p>
<p>Click create Microsoft App ID and password. You’ll be provided with an app ID and a button to generate password.<br>Replace these values in app.js<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Create chat bot</span></div><div class="line"><span class="keyword">var</span> connector = <span class="keyword">new</span> builder.ChatConnector(&#123;</div><div class="line">   <span class="attr">appId</span>: process.env.MICROSOFT_APP_ID,</div><div class="line">   <span class="attr">appPassword</span>: process.env.MICROSOFT_APP_PASSWORD</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>After completing form and registering bot successfully, update your azure site where bot is hosted repeat git push steps above and add the bot on skype.</p>
<p>This is the breakdown of the inital setup.<br>Next time you add a node.js bot, you should only need to</p>
<ol>
<li>get app.js sample</li>
<li><code>npm init</code></li>
<li><code>git init</code></li>
<li><code>npm install</code>  (required dependencies)</li>
<li><code>azure site create --git {site name}</code></li>
<li><code>git add .</code></li>
<li><code>git commit -m &quot;{message}&quot;</code></li>
<li><code>git push azure master</code></li>
<li><a href="https://dev.botframework.com/bots/new" target="_blank" rel="external">Register the bot</a>, place supplied ID and password in app.js</li>
<li><code>git push azure master</code></li>
</ol>
</article><section id="comments"><h2>Comments<div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus</a>.</noscript></div></h2></section></main><script async>(function(h,g,l,k,j,i){j=h.createElement(g),i=h.getElementsByTagName(g)[0],
j.src = '//' + l + '.disqus.com/' + k + '.js', i.parentNode.insertBefore(j, i)})
(document,'script','http-teachtyler-github-io','embed');
</script><script async>var disqus_shortname = 'http-teachtyler-github-io';
(function () {
var s = document.createElement('script'); s.async = true;
s.type = 'text/javascript';
s.src = '//' + disqus_shortname + '.disqus.com/count.js';
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
}());
</script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
e=o.createElement(i);r=o.getElementsByTagName(i)[0];
e.src='//www.google-analytics.com/analytics.js';
r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
ga('create','UA-81517801-1');ga('send','pageview');</script></body></html>